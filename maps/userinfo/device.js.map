/**
 *  @name:      redcore-webUI
 *  @version:   1.0.0
 *  @author:    redcore
 *  @desc:      redcore 内核webUI 页面开发
 *  @license:   ISC
 *  @copyright: Copyright 2018 The Redcore (Beijing) Technology Co.,Ltd. All rights reserved.
 */
{"version":3,"sources":["userinfo/device.js"],"names":["device_ins","Symbol","for","rdc_device_dom_init","rdc_device_evt_init","Device","[object Object]","opt","this","cfg","holder","$","arrDevices","Object","assign","getDeviceInfo","initEvt","ins","str","test","data","concat","html","map","item","discernDevice","operatingSystem","user","name","model","id","clientVersion","Rdc","formateTime","lastLoginTime","lastLoginPos","join","find","each","idx","img","Image","src","attr","append","that","delegate","parents","index","chrome","send"],"mappings":"AAIA,MAAMA,WAAaC,OAAOC,IAAI,kBACxBC,oBAAsBF,OAAOC,IAAI,uBACjCE,oBAAsBH,OAAOC,IAAI,uBACvC,MAAMG,OACJC,YAAYC,GACVC,KAAKC,IAAM,CACTC,OAAQC,EAAE,mBACVC,WAAY,IAEdC,OAAOC,OAAON,KAAKC,IAAKF,GACxBC,KAAKO,gBACLP,KAAKQ,UAGPC,iBAIE,OAHKT,KAAKR,aAAoC,OAArBQ,KAAKR,cAC5BQ,KAAKR,YAAc,IAAIK,QAElBG,KAAKR,YAGdM,cAAcY,GACZ,MAAO,WAAWC,KAAKD,GAAO,wBAC5B,WAAWC,KAAKD,GAAO,qBACvB,QAAQC,KAAKD,GAAO,qBACpB,UAAUC,KAAKD,GAAO,oBACtB,QAAQC,KAAKD,GAAO,kBACpB,SAASC,KAAKD,GAAO,mBACrB,iBAGJZ,QAAQc,GACNZ,KAAKC,IAAIG,WAAa,GAAGS,OAAOD,EAAKA,MACrCZ,KAAKC,IAAIC,OAAOY,sBAAsBF,EAAKA,KAAKG,IAAIC,6GAGnBhB,KAAKiB,cAAcD,EAAKE,sFAGlDlB,KAAKC,IAAIkB,KAAKC,4BACdJ,EAAKK,oZAYFL,EAAKE,sIAILF,EAAKM,0HAILN,EAAKO,sIAILC,IAAIC,YAAYT,EAAKU,gBAAkB,2HAIvCV,EAAKW,cAAgB,iLAMvBC,KAAK,SACb5B,KAAKC,IAAIC,OAAO2B,KAAK,QAAQC,KAAK,SAASC,EAAKf,GAC9C,IAAIgB,EAAM,IAAIC,MACdD,EAAIE,IAAM/B,EAAEa,GAAMmB,KAAK,eACvBhC,EAAEa,GAAMoB,OAAOJ,GACf7B,EAAEa,GAAMmB,KAAK,cAAe,MAIhCrC,UACE,IAAIuC,EAAOrC,KACXA,KAAKC,IAAIC,OAAOoC,SAAS,WAAY,QAAS,WAC5C,IAAIP,EAAM5B,EAAEH,MAAMuC,QAAQ,WAAWC,QAAU,EAE/C,OADAC,OAAOC,KAAK,eAAgB,CAACL,EAAKpC,IAAIG,WAAW2B,GAAKT,MAC/C,IAIXxB,gBACE2C,OAAOC,KAAK","file":"../../src/userinfo/device.js","sourcesContent":["// Copyright 2018 The Redcore (Beijing) Technology Co.,Ltd. All rights reserved.\r\n// Use of this source code is governed by a BSD-style license that can be\r\n// found in the LICENSE file.\r\n\r\nconst device_ins = Symbol.for('rdc_device_ins')\r\nconst rdc_device_dom_init = Symbol.for('rdc_device_dom_init')\r\nconst rdc_device_evt_init = Symbol.for('rdc_device_evt_init')\r\nclass Device {\r\n  constructor(opt) {\r\n    this.cfg = {\r\n      holder: $('#rdc_device_set'),\r\n      arrDevices: []\r\n    }\r\n    Object.assign(this.cfg, opt)\r\n    this.getDeviceInfo()\r\n    this.initEvt()\r\n  }\r\n\r\n  static get ins() {\r\n    if (!this[device_ins] || this[device_ins] === null) {\r\n      this[device_ins] = new Device()\r\n    }\r\n    return this[device_ins]\r\n  }\r\n\r\n  discernDevice(str) {\r\n    return /windows/i.test(str) ? './imgs/windows_pc.png' :\r\n      /Android/i.test(str) ? './imgs/android.png' :\r\n      /os x/i.test(str) ? './imgs/macbook.png' :\r\n      /iphone/i.test(str) ? './imgs/iphone.png' :\r\n      /ipad/i.test(str) ? './imgs/iPad.png' :\r\n      /linux/i.test(str) ? './imgs/linux.png' :\r\n      './imgs/mac.png'\r\n  }\r\n\r\n  initDOM(data) {\r\n    this.cfg.arrDevices = [].concat(data.data)\r\n    this.cfg.holder.html(`<h5>设备管理</h5> ${data.data.map(item => \r\n\t\t\t`<div class=\"rdc-info device\">\r\n\t\t\t\t<div class=\"rdc-head\">\r\n\t\t\t\t\t<div class=\"img\" data-imgSrc=\"${this.discernDevice(item.operatingSystem)}\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"info\">\r\n\t\t\t\t\t\t<p>${this.cfg.user.name}</p>\r\n\t\t\t\t\t\t<p>${item.model}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-ctl\">\r\n\t\t\t\t\t\t<button class=\"rdc-btn-icon on\">\r\n\t\t\t\t\t\t\t<span class=\"rdc-shadow\"></span>\r\n\t\t\t\t\t\t\t<span class=\"rdc-caret-arrow rdc-pos-mm\"></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"rdc-content\">\r\n\t\t\t\t\t<div class=\"rdc-form-row\">\r\n\t\t\t\t\t\t<label>操作系统</label>\r\n\t\t\t\t\t\t<span>${item.operatingSystem}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-form-row\">\r\n\t\t\t\t\t\t<label>设备ID</label>\r\n\t\t\t\t\t\t<span>${item.id}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-form-row\">\r\n\t\t\t\t\t\t<label>客户端版本</label>\r\n\t\t\t\t\t\t<span>${item.clientVersion}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-form-row\">\r\n\t\t\t\t\t\t<label>上次登录时间</label>\r\n\t\t\t\t\t\t<span>${Rdc.formateTime(item.lastLoginTime) || ''}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-form-row\">\r\n\t\t\t\t\t\t<label>上次登录位置</label>\r\n\t\t\t\t\t\t<span>${item.lastLoginPos || ''}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"rdc-ctl-br\">\r\n\t\t\t\t\t\t<button class=\"rdc-btn\" data-id=\"\">删除设备</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>`).join(' ')} `);\r\n    this.cfg.holder.find('.img').each(function(idx, item) {\r\n      let img = new Image()\r\n      img.src = $(item).attr('data-imgSrc')\r\n      $(item).append(img)\r\n      $(item).attr('data-imgSrc', '')\r\n    })\r\n  }\r\n\r\n  initEvt() {\r\n    let that = this;\r\n    this.cfg.holder.delegate('.rdc-btn', 'click', function() {\r\n      let idx = $(this).parents('.device').index() - 1\r\n      chrome.send('deleteDevice', [that.cfg.arrDevices[idx].id])\r\n      return false;\r\n    })\r\n  }\r\n\r\n  getDeviceInfo() {\r\n    chrome.send('getDeviceInfo')\r\n  }\r\n}\r\n"]}