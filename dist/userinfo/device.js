/**
 *  @name:      redcore-webUI
 *  @version:   1.0.0
 *  @author:    redcore
 *  @desc:      redcore 内核webUI 页面开发
 *  @license:   ISC
 *  @copyright: Copyright 2018 The Redcore (Beijing) Technology Co.,Ltd. All rights reserved.
 */
const device_ins=Symbol.for("rdc_device_ins"),rdc_device_dom_init=Symbol.for("rdc_device_dom_init"),rdc_device_evt_init=Symbol.for("rdc_device_evt_init");class Device{constructor(t){this.cfg={holder:$("#rdc_device_set"),arrDevices:[]},Object.assign(this.cfg,t),this.getDeviceInfo(),this.initEvt()}static get ins(){return this[device_ins]&&null!==this[device_ins]||(this[device_ins]=new Device),this[device_ins]}discernDevice(t){return/windows/i.test(t)?"./imgs/windows_pc.png":/Android/i.test(t)?"./imgs/android.png":/os x/i.test(t)?"./imgs/macbook.png":/iphone/i.test(t)?"./imgs/iphone.png":/ipad/i.test(t)?"./imgs/iPad.png":/linux/i.test(t)?"./imgs/linux.png":"./imgs/mac.png"}initDOM(t){this.cfg.arrDevices=[].concat(t.data),this.cfg.holder.html(`<h5>设备管理</h5> ${t.data.map(t=>`<div class="rdc-info device">\n\t\t\t\t<div class="rdc-head">\n\t\t\t\t\t<div class="img" data-imgSrc="${this.discernDevice(t.operatingSystem)}">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="info">\n\t\t\t\t\t\t<p>${this.cfg.user.name}</p>\n\t\t\t\t\t\t<p>${t.model}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-ctl">\n\t\t\t\t\t\t<button class="rdc-btn-icon on">\n\t\t\t\t\t\t\t<span class="rdc-shadow"></span>\n\t\t\t\t\t\t\t<span class="rdc-caret-arrow rdc-pos-mm"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="rdc-content">\n\t\t\t\t\t<div class="rdc-form-row">\n\t\t\t\t\t\t<label>操作系统</label>\n\t\t\t\t\t\t<span>${t.operatingSystem}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-form-row">\n\t\t\t\t\t\t<label>设备ID</label>\n\t\t\t\t\t\t<span>${t.id}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-form-row">\n\t\t\t\t\t\t<label>客户端版本</label>\n\t\t\t\t\t\t<span>${t.clientVersion}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-form-row">\n\t\t\t\t\t\t<label>上次登录时间</label>\n\t\t\t\t\t\t<span>${Rdc.formateTime(t.lastLoginTime)||""}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-form-row">\n\t\t\t\t\t\t<label>上次登录位置</label>\n\t\t\t\t\t\t<span>${t.lastLoginPos||""}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rdc-ctl-br">\n\t\t\t\t\t\t<button class="rdc-btn" data-id="">删除设备</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`).join(" ")} `),this.cfg.holder.find(".img").each(function(t,i){let n=new Image;n.src=$(i).attr("data-imgSrc"),$(i).append(n),$(i).attr("data-imgSrc","")})}initEvt(){let t=this;this.cfg.holder.delegate(".rdc-btn","click",function(){let i=$(this).parents(".device").index()-1;return chrome.send("deleteDevice",[t.cfg.arrDevices[i].id]),!1})}getDeviceInfo(){chrome.send("getDeviceInfo")}}